# 4.5 CPU 코어 수와 스레드 수 사이의 관계는 무엇일까?

## 4.5.1 레시피와 코드, 볶음 요리와 스레드

> CPU 코어 수와 스레드 수 사이에는 어떤 필연 관계도 없다.

- CPU는 기계 명령어에 따라 프로세스와 스레드를 실행
- CPU가 사용자 상태에서 실행하는 명령어는 모두 스레드 또는 특정 스레드에 속해 있다.
- CPU = 하드웨어
- 스레드 = 소프트웨어, 실행 흐름이자 작업
- CPU는 PC 레지스터 주소에 따라 메모리에서 기계 명령어를 꺼내 실행만 한다.

## 4.5.2 작업 분할과 블로킹 입출력

**스레드**

- 프로그래머에게 매우 편리한 추상화 방법을 제공
  - 작업 하나를 여러 개로 분할
  - 각각의 하위 작업을 별도의 스레드에 배치
  - 운영 체제에서 이를 스케줄링하고 실행할 수 있다. <br>
    => 동시에 여러 작업을 실행

**사용 예시**

- 사용자 인터페이스 요소 뒤에서 대량의 계산을 수행 -> 계산 작업을 별도의 스레드에 넣어 수행하는 동안 사용자 인터페이스가 멈추는 것을 방지
- 블로킹 입출력
  - 블로킹 호출이 실행되면 운영 체제가 전체 스레드를 일시 중지
  - 이를 별도의 스레드에서 실행하면 나머지 코드는 영향 없이 계속 실행

## 4.5.3 다중 코어와 다중 스레드

**다중 프로세스 프로그래밍**

- 매우 번거롭다.
- 프로세스 간 통신 방식이 필요하다.
- 프로세스 간 전환에 드는 비용과 같은 문제가 있다.

=> 스레드가 이런 문제의 해결책이 되었다.

**다중 코어를 활용하는 스레드**

- 스레드 수는 코어 수와 일정한 선형 관계를 유지
- 입출력이나 동기화 같은 작업이 없다면, 코어당 스레드 하나가 가장 나은 선택
- 스레드 수를 적당히 늘려 운영 체제가 CPU에 할당할 수 있는 충분한 스레드를 확보하면 시스템 성능 향상 가능
- 한계에 달하면 운영 체제 성능 떨어짐 -> 다른 스레드로 전환할 때 부담 증가
