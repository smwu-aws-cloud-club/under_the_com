# Additional Research

## 프로세스에 우선순위를 할당하고, 우선순위에 따라 스케줄러(scheduler)가 스케줄링을 할 수 있도록

> 앞에 있는 것보다 더 중요한 게 뒤에 들어오면 처리하는 방법이 있었는데. 어떻게 했더라?

https://oo.ai/s/oQdAxSBa8k8WDDes5zsy

**선점형 우선순위 스케줄링 (Preemptive Priority Scheduling)**

- 현재 실행 중인 프로세스보다 높은 우선순위를 가진 프로세스가 준비 큐에 도착하면, 현재 실행 중인 프로세스를 중단(선점)하고 높은 우선순위의 프로세스에게 CPU를 할당하는 방식

**동작 방식**

- 각 프로세스에 우선순위를 할당한다. 우선순위는 정수값으로 표현되며, 값이 낮을수록 높은 우선순위를 가지는 경우가 많다.
- CPU는 준비 큐에서 가장 높은 우선순위를 가진 프로세스에 할당된다.
- 새로운 프로세스가 준비 큐에 도착하면, 해당 프로세스의 우선순위가 현재 실행 중인 프로세스의 우선순위와 비교된다.
- 새로운 프로세스의 우선순위가 더 높으면, 현재 실행 중인 프로세스는 준비 큐로 이동하고, 새로운 프로세스가 CPU를 할당받아 실행된다.
- 만약 우선순위가 동일한 프로세스들이 있다면, 일반적으로 FCFS(First-Come, First-Served) 방식을 사용하여 순서를 결정한다.

**장점**

- 긴급하거나 중요한 프로세스를 즉시 처리할 수 있다.
- 응답성이 중요한 시스템에 적합하다.

**단점**

- 낮은 우선순위의 프로세스가 CPU를 할당받지 못하는 기아(Starvation) 현상이 발생할 수 있다.
- 잦은 문맥 교환(Context Switching)으로 인한 오버헤드가 발생할 수 있다.

## 분기 예측... 프로그램 실행 이력을 기반으로 예측을 실행하는 등 여러 가지 데이터를 기반으로 합니다.

> 어떤 걸 기반으로 할까?

https://oo.ai/s/pbGgGtij9qGo0hW4uVN1

**분기 예측에 사용되는 데이터 유형**
    
- 프로그램 실행 이력: 과거 분기 명령의 실행 결과(taken 또는 not taken)를 기록하여, 이를 바탕으로 미래의 분기 방향을 예측한다.
- 분기 명령어 주소: 분기 명령어의 주소를 사용하여, 이전에 실행된 분기 명령의 정보를 활용한다.
- 분기 방향: 분기가 순방향인지 역방향인지에 따라 예측을 달리합니다. 예를 들어, BTFNT(Backward Taken, Forward Not Taken) 방식은 역방향 분기는 taken, 순방향 분기는 not taken으로 예측한다.
- 최근 실행된 분기 명령어 결과: 최근에 실행된 분기 명령어의 결과를 활용하여, 현재 분기 명령어의 결과를 예측한다.
- 글로벌 히스토리 레지스터(GHR): 모든 분기의 T/NT (Taken/Not Taken) 이력을 추적하는 레지스터를 활용하여 예측 정확도를 높인다.
- 패턴 히스토리 테이블(PHT): GHR을 인덱스로 사용하여 각 인덱스별로 어떤 결과(2비트 카운터)를 가졌는지 저장하는 테이블을 사용한다.

## 최신 CPU의 분기 예측은 매우 정확... 정렬되지 않은 배열을 사용하더라도 동전 던지기와 달리 분기 예측 실패율이 50%에 달하지 않음

> 어떻게 이럴 수 있는 거지? 실패 or 성공이 아닌가?

https://oo.ai/s/CArMofGtO2wOdubIiKbi

**분기 예측의 작동 방식**

- 과거 이력 활용: CPU는 분기 명령어의 과거 실행 이력을 기록하고, 이를 바탕으로 다음에 어떤 방향으로 분기할지 예측한다.
- 패턴 인식: 분기 예측기는 반복되는 패턴을 식별하고, 이를 통해 높은 확률로 정확한 예측을 수행한다. 예를 들어, 루프의 경우 대부분 반복되므로 '분기됨(taken)'으로 예측하는 것이 유리하다.
- 동적 예측: 실행 시간 정보를 활용하여 분기 예측을 수행하며, 정적 예측보다 높은 정확도를 보인다.


**높은 분기 예측 정확도의 이유**
- 프로그램의 경향성: 프로그램 내의 각 분기 명령어는 대부분 분기되거나(taken) 분기되지 않거나(not taken) 둘 중 한쪽의 경향을 보이는 경우가 많다.
- 다양한 예측 기법: CPU는 다양한 분기 예측 기법(예: 2비트 예측기, 연관 분기 예측기, 토너먼트 예측기 등)을 조합하여 사용함으로써 예측 정확도를 높인다.
- 학습 효과: 분기 예측기는 과거의 예측 성공/실패 여부를 학습하여 예측 모델을 개선하므로, 시간이 지날수록 정확도가 향상된다.