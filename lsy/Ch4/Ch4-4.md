## 4.4 CPU가 if 문을 만났을 때

### 4.4.1 파이프라인 기술의 탄생
하나의 결과를 내기 위해 중간 과정들을 전부 조각내 파이프라인 식으로 처리한다면?
- 자동차 하나를 만들 때
  1. 하나의 팀이 전 과정을 수행하는 것 -> 비효율적
  2. 여러 팀이 각 과정을 맡아 넘겨주는 방식으로 수행하는 것 (파이프라인) -> 더 짧은 시간 내에 많은 자동차를 만들 수 있다.

### 4.4.2 CPU : 메가팩토리와 파이프라인
CPU가 담당하는 것은 기계 명령어 실행이다. 기계 명령어 하나를 처리하는 과정은 4단계.
1. 명령어 인출
2. 명령어 해독
3. 실행
4. 다시 쓰기

각 단계는 별도의 하드웨어에서 실행되며, 파이프라인 방식으로 1초에 수십억 개의 기계명령어를 수행할 수 있다.

### 4.4.3 if가 파이프라인을 만나면
이전 명령어의 실행이 완료되기 전에 그 다음 명령어가 파이프라인에 들어가야 한다. 그런데 만약 그 다음 명령어에 if문 같은 분기 문이 존재해 조건부 점프 명령어가 실행된다면? 어떻게 알맞은 파이프라인에 미리 배치될 수 있을까?

### 4.4.4 분기 예측 : 가능한 한 CPU가 올바르게 추측하도록
CPU는 해당 명령어가 어디로 분기할 가능성이 있는지 추측한다. 
만약 배열 내의 값이 100보다 큰지 작은지를 기준으로 분기하는 if문이 있다면?
- 해당 배열이 정렬되어 있는 경우 -> CPU는 대부분 분기 추측 성공
- 해당 배열이 정렬되어 있지 않은 경우 -> CPU의 분기 추측 성공 가능성이 떨어짐

프로그래머는..
- if문을 사용할 때 CPU가 높은 확률로 추측할 수 있도록 코드를 작성해야 한다. 
- CPU가 추측에 실패하면 성능 손실이 발생하기 때문!

최신 CPU의 분기 예측은 매우 정확하다.